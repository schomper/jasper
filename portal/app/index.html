<!DOCTYPE html>
<html ng-app="portalApp">
    <head>
        <meta charset="utf-8">
        <title>Portal</title>
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
        <script src="http://cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.10/angular.min.js"></script>
        <script src="http://cdnjs.cloudflare.com/ajax/libs/angular.js/1.2.10/angular-route.min.js"></script>
        <script src="../node_modules/angular-bootstrap/ui-bootstrap.js"></script>
        <script src="../node_modules/angular-bootstrap/ui-bootstrap-tpls.min.js"></script>
        <script>
            var portalApp = angular.module('portalApp', ['ngRoute', 'ui.bootstrap', 'ui.bootstrap.pagination']);
            /* Runs ones at the start of the app */
            portalApp.config(function($routeProvider){
                $routeProvider.
                    when('/', {
                        templateUrl: 'article-list.html',
                        controller: 'ArticleListCtrl'
                    }).
                    otherwise({
                        redirectTo: '/'
                    });
            });

            /* Create our own dependancy injection          *
             * removes the need to load data multiple times */
            portalApp.factory('articles', function($http){

                function getData(callback) {
                    $http({
                        method: 'GET',
                        url: 'articles.json',
                        cache: true
                    }).success(callback);
                }

                return {
                    list: getData,
                    find: function(name, callback) {
                        getData(function(data) {
                            var article = data.filter(function(entry){
                                return entry.name === name;
                            })[0];
                            callback(article);
                        });
                    }
                };
            });

            portalApp.controller('ArticleListCtrl', function($scope, articles) {
                $scope.totalItems = 100;
                $scope.currentPage = 1;

                $scope.setPage = function (pageNo) {
                  $scope.currentPage = pageNo;
                };

                $scope.pageChanged = function() {
                  $log.log('Page changed to: ' + $scope.currentPage);
                };

                $scope.maxSize = 5;

                articles.list(function(articles) {
                    $scope.articles = articles.articles;
                });
            });
        </script>
    </head>

    <body>
        <div ng-view></div>
    </body>
</html>
